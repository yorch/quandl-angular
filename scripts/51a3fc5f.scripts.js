"use strict";angular.module("quandlAngularApp",["ngRoute","ngCookies","ngResource","ngSanitize","ui.bootstrap"]).config(["$logProvider",function(a){a.debugEnabled(!0)}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/searchDataSets",{templateUrl:"views/searchDataSets.html",controller:"SearchDataSetsCtrl"}).when("/getDataSet/:source_code/:code",{templateUrl:"views/getDataSet.html",controller:"GetDataSetCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("quandlAngularApp").service("appSettings",function(){return{apiToken:"",apiBaseUrl:"http://www.quandl.com/api/v1/",apiExt:"json"}}),angular.module("quandlAngularApp").service("apiUrl",["appSettings",function(a){return{toQueryString:function(a){var b=[];a=a||{};for(var c in a)a.hasOwnProperty(c)&&a[c]&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},buildUrl:function(b,c){var d={auth_token:a.apiToken};return angular.extend(c,d),a.apiBaseUrl+b+"."+a.apiExt+"?"+this.toQueryString(c)}}}]),angular.module("quandlAngularApp").service("dataSet",["$http","$log","apiUrl","limitToFilter",function(a,b,c,d){var e=function(a){var b="datasets",d={query:a};return c.buildUrl(b,d)};return{search:function(c,d){var f=e(c);b.debug("Searching DataSets",c,"at",f),a.get(f).success(function(a){b.debug("Search DataSet Success",c,"result",a),d(a)})},promise_search:function(c){var f=e(c);return b.debug("Searching DataSets",c,"at",f),a.get(f).then(function(a){return d(a.data.docs,15)})},get:function(a,b){this.get_with_filter(a,null,null,b)},get_with_filter:function(d,e,f,g){var h="datasets/"+d,i={trim_start:e,trim_end:f},j=c.buildUrl(h,i);b.debug("Getting DataSet",d,"at",j),a.get(j).success(function(a){b.debug("DataSet Success",d,"result",a),g(a)})}}}]),angular.module("quandlAngularApp").filter("startFrom",function(){return function(a,b){return a?(b=+b,a.slice(b)):void 0}}),angular.module("quandlAngularApp").controller("MainCtrl",["$scope","$http","$log","appSettings","dataSet",function(a,b,c,d,e){a.model={dataSet:{},filter:{dataSet:"BITCOIN/MTGOXUSD",startDate:"2013-09-01",endDate:"2013-12-31"}},a.searchDataSets=function(a){return e.promise_search(a)},a.getDataSet=function(){e.get_with_filter(a.model.filter.dataSet,a.model.filter.startDate,a.model.filter.endDate,function(b){a.model.dataSet=b})},a.clearDataSet=function(){a.model.dataSet={}}}]),angular.module("quandlAngularApp").controller("NavigationCtrl",["$scope","$location",function(a,b){a.gotoHome=function(){b.path("/")},a.isHome=function(){return"/"===b.path()},a.gotoSearchDataSet=function(){b.path("/searchDataSets")},a.isSearchDataSets=function(){return"/searchDataSets"===b.path()}}]),angular.module("quandlAngularApp").controller("SearchDataSetsCtrl",["$scope","dataSet",function(a,b){a.currentPage=0,a.pageSize=10,a.data=[],a.search=function(){b.search(a.model.filter.name,function(b){a.data=b.docs})},a.numberOfPages=function(){return Math.ceil(a.data.length/a.pageSize)}}]),angular.module("quandlAngularApp").controller("GetDataSetCtrl",["$scope","$routeParams","dataSet",function(a,b,c){c.get(b.source_code+"/"+b.code,function(b){a.data=b})}]);